{% from "command.njk" import command_dialog %}

<div class="flex h-14 w-full items-center gap-2 px-4">
  <button
    type="button"
    onclick="document.dispatchEvent(new CustomEvent('basecoat:sidebar'))"
    aria-label="Toggle sidebar"
    data-tooltip="Toggle sidebar"
    data-side="bottom"
    data-align="start"
    class="btn-sm-icon-ghost size-7 -ml-1.5"
  >
    {% lucide "panel-left" %}
  </button>
  <button
    type="button"
    onclick="document.getElementById('site-search').showModal(); document.getElementById('site-search-input').focus();"
    class="btn-outline h-8 px-3 gap-2 text-muted-foreground font-normal mr-auto hidden sm:flex"
  >
    {% lucide "search", { "class": "size-4" } %}
    <span>Search docs...</span>
    <kbd class="kbd text-xs">âŒ˜K</kbd>
  </button>
  <button
    type="button"
    onclick="document.getElementById('site-search').showModal(); document.getElementById('site-search-input').focus();"
    aria-label="Search documentation"
    class="btn-sm-icon-ghost size-7 sm:hidden"
  >
    {% lucide "search" %}
  </button>
  <select
    class="select h-8 leading-none"
    id="theme-select"
  >
    <option value="">Default</option>
    <option value="claude">Claude</option>
    <option value="doom-64">Doom 64</option>
    <option value="supabase">Supabase</option>
  </select>
  <script>
    (() => {
      const themeSelect = document.getElementById('theme-select');
      const storedTheme = localStorage.getItem('themeVariant');
      if (themeSelect && storedTheme) themeSelect.value = storedTheme;
      themeSelect.addEventListener('change', () => {
        const newTheme = themeSelect.value;
        document.documentElement.classList.forEach(c => {
          if (c.startsWith('theme-')) document.documentElement.classList.remove(c);
        });
        if (newTheme) {
          document.documentElement.classList.add(`theme-${newTheme}`);
          localStorage.setItem('themeVariant', newTheme);
        } else {
          localStorage.removeItem('themeVariant');
        }
      });
    })();
  </script>

  <button
    type="button"
    aria-label="Toggle dark mode"
    data-tooltip="Toggle dark mode"
    data-side="bottom"
    onclick="document.dispatchEvent(new CustomEvent('basecoat:theme'))"
    class="btn-icon-outline size-8"
  >
    <span class="hidden dark:block">{% lucide "sun" %}</span>
    <span class="block dark:hidden">{% lucide "moon" %}</span>
  </button>
  <a
    href="https://github.com/hunvreus/basecoat"
    class="btn-icon size-8"
    target="_blank"
    rel="noopener noreferrer"
    data-tooltip="GitHub repository"
    data-side="bottom"
    data-align="end"
  >
    {% lucide "github" %}
  </a>
</div>

{{ command_dialog(
  id="site-search",
  placeholder="Search documentation...",
  empty_text="No results found. Try a different search term.",
  main_attrs={ "data-command-async": "true" },
  input_attrs={ "id": "site-search-input" }
) }}

<script>
  document.addEventListener('keydown', (e) => {
    if ((e.metaKey || e.ctrlKey) && e.key === 'k') {
      e.preventDefault();
      const dialog = document.getElementById('site-search');
      if (dialog) {
        dialog.showModal();
        document.getElementById('site-search-input')?.focus();
      }
    }
  });
</script>